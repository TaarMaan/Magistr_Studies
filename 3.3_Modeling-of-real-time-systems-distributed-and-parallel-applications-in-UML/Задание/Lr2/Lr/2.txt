Лабораторная работа №2
Цель и постановка задания
Получения навыков синхронного взаимодействия микросервисов.
Создание микросервиса компаний.
Создать отдельную схему БД. Спроектировать базу данных компаний, в
которых работают пользователи. У компаний должна храниться следующая
информация: название, сокращенное название, адрес (индекс, область, город,
улица, номер дома, номер офиса), ОГРН, ссылка на владельца компании
(микросервис пользователей).
Обновить configuration сервер, добавив в него новые настройки для
company микросервиса.
Расширить микросервис из 1 лабораторной работы, учитывая, что каждый
пользователь должен работать в одной компании. При апдейте юзера добавить
обязательным параметром ссылку на компанию (company_id). (Ендпоинт
создания юзера вывести из под секьюрити (через фильтр allowAll (как делали
при разделении роей по url)) Существование компании должно проверяться в
микросервисе компаний. При получении информации о юзерах, должно
выводиться наименование компании, в которой он работает.
Создать в микросервисе компаний ендпоинты, необходимые для
взаимодействия с микросервисом юзеров из 2 задания.
Создать ендпоинты для создания/обновления компании, поиск компаний по
фильтру (ФИО руководителя, наименование компании, ОГРН). Поля фильтра
должны работать как ИЛИ. При создании компании передается ссылка на
руководителя, которая должна проверяться на существование такого
пользователя (ендпоинт для проверки существования пользователя вывести из
под секьюрити). Если пользователя не существует – возвращается 404 ошибка,
с соответствующим описанием. При получении информации о компании
должна выводиться также информация о руководителе – ФИО.
Навесить на ендпоинты микросервиса секьюрити. Только пользователи
администраторы могут добавлять и обновлять компании. Обычным
пользователяи доступны остальные ендпоинты
Создать в Postman две коллекции. Первая – для вызова ендпоинтов юезр-
сервиса, вторая – для вызова ендпоинтов сервиса компаний. Добавить реквесты
для всех ендпоинтов.
Добавить коллекцию для логина. В ней должен быть один реквест для
логина под обычным пользователем и один под админом. После успешного
логина JWT токен должен сохраняться в переменную postman и добавляться в
Headers во всех запросах.
Все взаимодействия между микросервисами должны быть синхронными.
Общие настройки для двух микросервисов должны быть вынесены в общие
настройки в конфиг сервере.